%PDF-1.4
1 0 obj
<< /Type /Catalog /Pages 2 0 R >>
endobj
2 0 obj
<< /Type /Pages /Count 3 /Kids [ 4 0 R 6 0 R 8 0 R ] >>
endobj
3 0 obj
<< /Type /Font /Subtype /Type1 /BaseFont /Helvetica >>
endobj
4 0 obj
<< /Type /Page /Parent 2 0 R /MediaBox [0 0 595 842] /Resources << /Font << /F1 3 0 R >> >> /Contents 5 0 R >>
endobj
5 0 obj
<< /Length 1837 >>
stream
BT
/F1 12 Tf
40 790 Td
16 TL
(CUSTOM CHANGES SUMMARY) Tj
T*
() Tj
T*
() Tj
T*
(This document summarizes all custom changes applied to the plugin in this workspace.) Tj
T*
() Tj
T*
(1\) PREVENT EMPTY YEAR/MONTH FOLDERS) Tj
T*
() Tj
T*
(Problem: Uploads created empty folders like `2026/02` during imports.) Tj
T*
() Tj
T*
(Fix: Avoid creating year/month folders unless a file is actually copied into uploads.) Tj
T*
() Tj
T*
(Where:) Tj
T*
(- `Plugin::handle_import_file\(\)` in class.add-from-server.php) Tj
T*
() Tj
T*
(Notes:) Tj
T*
(- `wp_upload_dir\( $time, false \)` is used when only reading upload paths.) Tj
T*
(- Actual folder creation happens only when copying files into uploads.) Tj
T*
() Tj
T*
(---) Tj
T*
() Tj
T*
(2\) DATE LOGIC HARDENED TO AVOID INVALID PATHS) Tj
T*
() Tj
T*
(Problem: Files were ending up in invalid folders such as `1770/89` or `1640/95`.) Tj
T*
() Tj
T*
(Fixes:) Tj
T*
(- Base `$time` on file modification time when possible.) Tj
T*
(- Clamp invalid/extreme timestamps \(before 1970 or too far in future\) back to current) Tj
T*
(time.) Tj
T*
(- If a `YYYY/MM` segment exists in the source path, only use it when the year/month is) Tj
T*
(valid.) Tj
T*
() Tj
T*
(Where:) Tj
T*
(- `Plugin::handle_import_file\(\)` in class.add-from-server.php) Tj
T*
() Tj
T*
(---) Tj
T*
() Tj
T*
(3\) FORCED IMPORTS INTO A PLUGIN-SPECIFIC SUBFOLDER) Tj
T*
() Tj
T*
(Goal: All imports should go into a single plugin folder, not year/month directories.) Tj
T*
() Tj
T*
(Implementation:) Tj
T*
(- Added helper `Plugin::get_import_uploads_dir\(\)` to build a prefixed uploads subdir.) Tj
T*
(- Default prefix: `uploads/add-from-server-reloaded/`.) Tj
T*
(- All copied/moved imports now go into this prefixed folder.) Tj
T*
() Tj
T*
(Where:) Tj
T*
(- `Plugin::get_import_uploads_dir\(\)` in class.add-from-server.php) Tj
ET
endstream
endobj
6 0 obj
<< /Type /Page /Parent 2 0 R /MediaBox [0 0 595 842] /Resources << /Font << /F1 3 0 R >> >> /Contents 7 0 R >>
endobj
7 0 obj
<< /Length 1882 >>
stream
BT
/F1 12 Tf
40 790 Td
16 TL
(- `Plugin::handle_import_file\(\)` uses the helper for destination paths.) Tj
T*
() Tj
T*
(Filter:) Tj
T*
(- `afsrreloaded_upload_subdir` controls the prefix \(set to empty string to disable\).) Tj
T*
() Tj
T*
(---) Tj
T*
() Tj
T*
(4\) MOVE FILES ALREADY INSIDE UPLOADS INTO THE PLUGIN FOLDER) Tj
T*
() Tj
T*
(Goal: Even files that were already in uploads should end up in the plugin subfolder.) Tj
T*
() Tj
T*
(Implementation:) Tj
T*
(- If a file is already in uploads but not in the plugin subfolder, it is moved \(rename or) Tj
T*
(copy+unlink fallback\).) Tj
T*
() Tj
T*
(Where:) Tj
T*
(- `Plugin::handle_import_file\(\)` in class.add-from-server.php) Tj
T*
() Tj
T*
(---) Tj
T*
() Tj
T*
(5\) FOLDER IMPORT SKIPS RESTRICTED FILES AND SHOWS A SUMMARY) Tj
T*
() Tj
T*
(Goal: When importing a folder, restricted files should be skipped and one summary message) Tj
T*
(shown \(not one error per file\).) Tj
T*
() Tj
T*
(Implementation:) Tj
T*
(- Folder scan collects restricted files and omits them from the import list.) Tj
T*
(- One summary notice shows the number of skipped files and all restricted extensions.) Tj
T*
() Tj
T*
(Where:) Tj
T*
(- `Plugin::handle_imports\(\)` in class.add-from-server.php) Tj
T*
(- `Plugin::get_files_from_folder\(\)` in class.add-from-server.php) Tj
T*
(- New helper `Plugin::get_restricted_extensions\(\)` and updated) Tj
T*
(`Plugin::is_restricted_file\(\)`.) Tj
T*
() Tj
T*
(Message Example:) Tj
T*
(- “16 files were skipped for security reasons. Some files in the selected folders were not) Tj
T*
(imported because their file types are not allowed: PHP, PHTML, PHPS, PHT, PHAR, EXE, SH,) Tj
T*
(BAT, CMD.”) Tj
T*
() Tj
T*
(---) Tj
T*
() Tj
T*
(6\) RESTRICTED EXTENSIONS LIST CENTRALIZED) Tj
T*
() Tj
T*
(Goal: Ensure the notice lists all restricted types consistently.) Tj
T*
() Tj
T*
(Implementation:) Tj
ET
endstream
endobj
8 0 obj
<< /Type /Page /Parent 2 0 R /MediaBox [0 0 595 842] /Resources << /Font << /F1 3 0 R >> >> /Contents 9 0 R >>
endobj
9 0 obj
<< /Length 1273 >>
stream
BT
/F1 12 Tf
40 790 Td
16 TL
(- Added `get_restricted_extensions\(\)` to centralize the list.) Tj
T*
(- Summary message uses this list.) Tj
T*
() Tj
T*
(Current restricted extensions:) Tj
T*
(`php`, `phtml`, `phps`, `pht`, `phar`, `exe`, `sh`, `bat`, `cmd`) Tj
T*
() Tj
T*
(---) Tj
T*
() Tj
T*
(7\) DEFAULT PREFIX NAME UPDATED) Tj
T*
() Tj
T*
(Change: Default uploads subdir prefix changed from `/afsrreloaded` to `/add-from-server-) Tj
T*
(reloaded`.) Tj
T*
() Tj
T*
(Where:) Tj
T*
(- `Plugin::get_import_uploads_dir\(\)` in class.add-from-server.php) Tj
T*
() Tj
T*
(---) Tj
T*
() Tj
T*
(8\) OUTPUT FORMATTING FOR FOLDER VS FILE SELECTION) Tj
T*
() Tj
T*
(Folder import output:) Tj
T*
(- Shows imported count.) Tj
T*
(- Shows “{FolderName} folder uploaded.”) Tj
T*
(- Shows duplicates count: “X files already exist in Media Library.”) Tj
T*
(- Shows skipped count and restricted extensions list.) Tj
T*
() Tj
T*
(Specific file selection output:) Tj
T*
(- Lists each duplicate as “filename: File already exists. View in Media Library”.) Tj
T*
(- Lists each restricted file as “filename: This file was not imported due to security) Tj
T*
(restrictions.”) Tj
T*
() Tj
T*
(---) Tj
T*
() Tj
T*
(FILES CHANGED) Tj
T*
() Tj
T*
(- class.add-from-server.php) Tj
ET
endstream
endobj
xref
0 10
0000000000 65535 f 
0000000009 00000 n 
0000000058 00000 n 
0000000129 00000 n 
0000000199 00000 n 
0000000325 00000 n 
0000002214 00000 n 
0000002340 00000 n 
0000004270 00000 n 
0000004396 00000 n 
trailer
<< /Size 10 /Root 1 0 R >>
startxref
5705
%%EOF